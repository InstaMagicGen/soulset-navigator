<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Soulset Navigator ‚Ä¢ Therapeutic Support</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@300;400;600;700&family=Playfair+Display:wght@600;700&display=swap" rel="stylesheet">

  <style>
    body{
      margin:0;
      font-family:Nunito, sans-serif;
      background:#050811;
      color:#f3f6ff;
      -webkit-font-smoothing:antialiased;
    }

    /* BACKGROUND SLIDESHOW ‚Äì FULLSCREEN + KEN BURNS EFFECT */
    .background-slideshow {
      position: fixed;
      inset: 0;
      width: 100%;
      height: 100vh;
      overflow: hidden;
      z-index: -2;
    }
    .background-slideshow .slide{
      position:absolute;
      top:-5%;
      left:-5%;
      width:110%;
      height:110%;
      object-fit:cover;
      opacity:0;
      transition:opacity 2.5s ease-in-out;
      animation:kenburns 22s ease-in-out infinite;
    }
    .background-slideshow .slide.active{
      opacity:1;
    }
    @keyframes kenburns{
      0%{transform:scale(1);}
      50%{transform:scale(1.08);}
      100%{transform:scale(1);}
    }

    /* Dark gradient overlay to keep text readable */
    .bg-overlay{
      position:fixed;
      inset:0;
      background:radial-gradient(circle at top, rgba(120,150,255,0.35), transparent 55%),
                 linear-gradient(to bottom, rgba(0,0,0,0.78), rgba(0,0,0,0.9));
      z-index:-1;
    }

    .page{
      min-height:100vh;
    }
    header{
      text-align:center;
      padding:30px 20px 8px;
    }
    header h1{
      font-family:"Playfair Display", serif;
      font-size:clamp(28px,4.8vw,38px);
      margin:0;
      letter-spacing:.04em;
    }
    header .subtitle{
  opacity:0;
  transform: translateY(8px);
  font-size:18px;
  margin-top:14px;
  max-width:640px;
  margin-left:auto;
  margin-right:auto;
  line-height:1.6;
  font-weight:600;
  color:#fdfdfd;
  text-shadow:
    0 0 12px rgba(255,255,255,0.25),
    0 0 20px rgba(90,163,166,0.25);
  animation: subtitleFadeIn 1.4s ease forwards;
}

/* Fade-in + slight slide-up */
@keyframes subtitleFadeIn{
  0%   { opacity:0; transform: translateY(8px); filter: blur(2px); }
  100% { opacity:1; transform: translateY(0); filter: blur(0); }
}

/* subtle breathing glow after appearing */
header .subtitle.breathe{
  animation:
    subtitleFadeIn 1.4s ease forwards,
    subtitleGlow 6s ease-in-out infinite 1.4s;
}

@keyframes subtitleGlow{
  0%,100% { text-shadow: 0 0 10px rgba(255,255,255,0.18), 0 0 18px rgba(90,163,166,0.18); }
  50%     { text-shadow: 0 0 14px rgba(255,255,255,0.30), 0 0 26px rgba(90,163,166,0.30); }
}


    .container{
      max-width:860px;
      margin:0 auto;
      padding:18px 20px 80px;
    }

    .card{
      background:rgba(6,12,28,0.92);
      border-radius:22px;
      padding:22px 20px;
      box-shadow:0 16px 40px rgba(0,0,0,0.45);
      margin-bottom:26px;
      border:1px solid rgba(255,255,255,0.04);
      backdrop-filter:blur(18px);
    }

    .card h2{
      margin:0 0 10px;
      font-size:20px;
      font-family:"Playfair Display", serif;
      letter-spacing:.03em;
    }

    .card p{
      margin-top:0;
      font-size:14px;
      color:#ccd4ff;
    }

    textarea{
      width:100%;
      min-height:110px;
      border-radius:14px;
      border:1.5px solid rgba(190,205,255,0.45);
      padding:14px;
      font-size:16px;
      background:rgba(5,10,30,0.9);
      resize:vertical;
      outline:none;
      color:#f3f6ff;
    }
    textarea::placeholder{
      color:#8992c5;
    }

    .actions{
      display:flex;
      gap:12px;
      margin-top:14px;
      flex-wrap:wrap;
      align-items:center;
    }

    .btn{
      flex:1;
      border:0;
      padding:13px 16px;
      border-radius:14px;
      font-size:15px;
      font-weight:700;
      cursor:pointer;
      background:#5aa3a6;
      color:white;
      box-shadow:0 10px 24px rgba(0,0,0,0.45);
    }
    .btn.secondary{
      background:transparent;
      border:1px solid rgba(190,205,255,0.45);
      color:#d7e0ff;
    }
    .btn:disabled{
      opacity:0.6;
      cursor:not-allowed;
    }

    .lang-select{
      min-width:140px;
      border-radius:999px;
      border:1px solid rgba(190,205,255,0.7);
      background:rgba(4,10,30,0.9);
      color:#dfe6ff;
      font-size:12px;
      padding:8px 12px;
    }
    .lang-select:focus{
      outline:none;
      border-color:#5aa3a6;
    }

    #status{
      margin-top:10px;
      font-size:13px;
      color:#d0d8ff;
    }

    #result .bubble{
      margin-top:18px;
      background:rgba(4,10,30,0.96);
      padding:16px 18px;
      border-radius:16px;
      box-shadow:0 10px 30px rgba(0,0,0,0.6);
      line-height:1.65;
      white-space:pre-line;
      border:1px solid rgba(163,186,255,0.28);
      color:#eef2ff;
      font-size:15px;
    }

    .sunset-block{
      display:none;
      text-align:center;
      margin-top:10px;
    }
    .sunset-btn{
      background:rgba(9,20,55,0.9);
      padding:12px 22px;
      border-radius:18px;
      font-weight:700;
      box-shadow:0 10px 26px rgba(0,0,0,0.6);
      backdrop-filter:blur(14px);
      color:#f3f6ff;
      border:1px solid rgba(190,205,255,0.4);
      font-size:15px;
    }

    /* IMMERSIVE SUNSET RESET */
    .sunset-fullscreen{
      position:fixed;
      inset:0;
      background:black;
      display:none;
      justify-content:center;
      align-items:center;
      flex-direction:column;
      z-index:9999;
    }
    .sunset-fullscreen video{
      position:absolute;
      inset:0;
      width:100%;
      height:100%;
      object-fit:cover;
    }
    .sunset-close{
      position:absolute;
      top:26px;
      right:24px;
      font-size:28px;
      color:white;
      padding:6px 14px;
      background:#ffffff33;
      border-radius:12px;
      cursor:pointer;
      backdrop-filter:blur(10px);
    }
    .sunset-timer{
      position:absolute;
      bottom:60px;
      color:white;
      font-size:40px;
      font-weight:700;
      text-shadow:0 2px 10px rgba(0,0,0,0.6);
    }

    .sunset-quote{
      position:absolute;
      inset:0;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:0 22px;
      text-align:center;
      color:#ffffff;
      font-size:18px;
      font-weight:500;
      text-shadow:0 2px 14px rgba(0,0,0,0.85);
    }

    @media (max-width:600px){
      .card{
        padding:18px 16px;
      }
      .sunset-timer{
        bottom:40px;
      }
      .sunset-quote{
        font-size:16px;
        padding:0 18px;
      }
    }
    header .subtitle{
  animation-delay: .4s;
}
/* --- Soulset internal banner (after analysis) --- */
.soulset-banner{
  margin-top:18px;
  background:linear-gradient(135deg, rgba(90,163,166,0.18), rgba(180,140,255,0.14));
  border:1px solid rgba(190,205,255,0.35);
  border-radius:16px;
  padding:14px 14px;
  display:flex;
  align-items:center;
  gap:12px;
  box-shadow:0 10px 26px rgba(0,0,0,0.45);
}
.soulset-banner .badge{
  font-size:20px;
  width:40px;height:40px;border-radius:12px;
  display:grid;place-items:center;
  background:rgba(255,255,255,0.08);
  border:1px solid rgba(255,255,255,0.12);
}
.soulset-banner .text{
  flex:1;
  font-size:14px;
  line-height:1.5;
  color:#eef2ff;
  font-weight:600;
}
.soulset-banner .cta{
  white-space:nowrap;
  background:#ffffff;
  color:#11152b;
  font-weight:800;
  border:0;
  padding:8px 12px;
  border-radius:999px;
  cursor:pointer;
  font-size:12px;
  box-shadow:0 6px 14px rgba(0,0,0,0.35);
}

/* --- Affiliate mini card (end of analysis) --- */
.affiliate-card{
  margin-top:12px;
  background:rgba(4,10,30,0.96);
  border:1px solid rgba(163,186,255,0.28);
  border-radius:14px;
  padding:12px 12px;
  display:flex;
  align-items:center;
  gap:10px;
}
.affiliate-card .ico{
  width:36px;height:36px;border-radius:10px;
  display:grid;place-items:center;
  background:rgba(255,255,255,0.08);
  font-size:18px;
}
.affiliate-card .copy{
  flex:1;
  font-size:13px;
  color:#e7ebff;
  line-height:1.45;
}
.affiliate-card a{
  color:#9fe7ea;
  font-weight:800;
  text-decoration:none;
  font-size:12px;
}
.affiliate-disclaimer{
  margin-top:6px;
  font-size:11px;
  color:#9aa6d9;
  opacity:0.9;
}

  </style>
</head>

<body>
  <!-- FULLSCREEN BACKGROUND IMAGES -->
  <div class="background-slideshow">
    <img src="sunset-1.jpeg" class="slide active" alt="Sunset 1">
    <img src="sunset-2.jpeg" class="slide" alt="Sunset 2">
    <img src="sunset-3.jpeg" class="slide" alt="Sunset 3">
    <img src="Sunset-4.jpeg" class="slide" alt="Sunset 4">
    <img src="Sunset-5.jpeg" class="slide" alt="Sunset 5">
    <img src="Sunset-6.jpeg" class="slide" alt="Sunset 6">
    <img src="Sunset-7.jpeg" class="slide" alt="Sunset 7">
  </div>
  <div class="bg-overlay"></div>

  <div class="page">
    <header>
      <h1 id="title">Soulset Navigator</h1>
      <div class="subtitle" id="subtitle"></div>
    </header>

    <div class="container">
      <!-- EMOTIONAL CHECK-IN -->
      <section class="card">
        <h2 id="check-title">Emotional Check-In</h2>
        <p id="check-desc">
          Describe what you're feeling. You will receive emotional reflection and therapeutic micro-practices.
        </p>

        <textarea id="inputText" placeholder="Ex: I feel overwhelmed‚Ä¶"></textarea>

        <div class="actions">
          <button class="btn" id="analyzeBtn">Reflect with me</button>
          <button class="btn secondary" id="clearBtn">Clear</button>
          <select id="analysisLangSelect" class="lang-select">
            <option value="auto">üåê System default</option>
            <option value="en">English</option>
            <option value="fr">Fran√ßais</option>
            <option value="es">Espa√±ol</option>
            <option value="ar">ÿßŸÑÿπÿ±ÿ®Ÿäÿ©</option>
          </select>
        </div>

        <div id="status"></div>
        <div id="result"></div>

<!-- Soulset internal banner (shows after analysis) -->
<div id="soulsetBanner" style="display:none;"></div>

      </section>

      <!-- SUNSET RESET BUTTON -->
      <div class="sunset-block" id="sunsetBlock">
        <button class="sunset-btn" id="sunsetBtn">üåÖ Sunset Reset (60s)</button>
      </div>
    </div>
  </div>

  <!-- IMMERSIVE SUNSET FULLSCREEN -->
  <div class="sunset-fullscreen" id="sunsetFS">
    <video id="sunsetVideo" autoplay muted playsinline></video>
    <div class="sunset-quote" id="sunsetQuote"></div>
    <div class="sunset-timer" id="sunsetTimer">60</div>
    <div class="sunset-close" id="sunsetClose">√ó</div>
  </div>

  <!-- AUDIO -->
  <audio id="sunsetAudio" preload="auto"></audio>

  <script>
    // ---------- Langues de base ----------
    const baseLang = (navigator.language || navigator.userLanguage || "en").substring(0,2).toLowerCase();
    let currentLang = baseLang;      // langue utilis√©e pour analyse + quotes
    let analysisLang = "";           // override manuel si choisi dans le select

    const langSelect = document.getElementById("analysisLangSelect");
    langSelect.addEventListener("change", () => {
      const v = langSelect.value;
      analysisLang = (v === "auto") ? "" : v;
    });

    function applyLanguageUI(){
  const subtitle   = document.getElementById("subtitle");
  const checkTitle = document.getElementById("check-title");
  const checkDesc  = document.getElementById("check-desc");
  const analyzeBtn = document.getElementById("analyzeBtn");
  const clearBtn   = document.getElementById("clearBtn");
  const inputText  = document.getElementById("inputText");
  const sunsetBtn  = document.getElementById("sunsetBtn");
  const autoOpt    = langSelect.querySelector('option[value="auto"]');

  if(baseLang === "fr"){
    subtitle.textContent = "Avant de parler √† un th√©rapeute, parlez √† votre guide int√©rieur. Il vous √©coute vraiment.";
    checkTitle.textContent = "Bilan √©motionnel";
    checkDesc.textContent = "D√©crivez ce que vous ressentez. Vous recevrez un miroir √©motionnel et des micro-pratiques th√©rapeutiques.";
    analyzeBtn.textContent = "Explorer avec moi";
    clearBtn.textContent = "Effacer";
    inputText.placeholder = "Ex : Je me sens submerg√©(e)‚Ä¶";
    sunsetBtn.textContent = "üåÖ Pause Sunset (60 s)";
    if(autoOpt) autoOpt.textContent = "üåê Langue du syst√®me";
  }
  else if(baseLang === "es"){
    subtitle.textContent = "Antes de hablar con un terapeuta, habla con tu gu√≠a interior. √âl realmente te escucha.";
    checkTitle.textContent = "Revisi√≥n emocional";
    checkDesc.textContent = "Describe lo que sientes. Recibir√°s un espejo emocional y micropr√°cticas terap√©uticas.";
    analyzeBtn.textContent = "Explorar conmigo";
    clearBtn.textContent = "Borrar";
    inputText.placeholder = "Ej: Me siento abrumado(a)‚Ä¶";
    sunsetBtn.textContent = "üåÖ Pausa Sunset (60 s)";
    if(autoOpt) autoOpt.textContent = "üåê Idioma del sistema";
  }
  else if(baseLang === "ar"){
    subtitle.textContent = "ŸÇÿ®ŸÑ ÿ£ŸÜ ÿ™ŸÑÿ¨ÿ£ ÿ•ŸÑŸâ ŸÖÿπÿßŸÑÿ¨ÿå ÿ™ÿ≠ÿØŸëÿ´ ÿ•ŸÑŸâ ÿØŸÑŸäŸÑŸÉ ÿßŸÑÿØÿßÿÆŸÑŸä‚ÄîŸÅŸáŸà ÿßŸÑŸàÿ≠ŸäÿØ ÿßŸÑÿ∞Ÿä ŸäŸÜÿµÿ™ ÿ•ŸÑŸäŸÉ ÿ≠ŸÇŸãÿß.";
    checkTitle.textContent = "ÿ™ŸÇŸäŸäŸÖ ÿπÿßÿ∑ŸÅŸä";
    checkDesc.textContent = "ÿµŸÅ ŸÖÿß ÿ™ÿ¥ÿπÿ± ÿ®Ÿá. ÿ≥ÿ™ÿ≠ÿµŸÑ ÿπŸÑŸâ ÿßŸÜÿπŸÉÿßÿ≥ ÿπÿßÿ∑ŸÅŸä ŸàŸÖŸÖÿßÿ±ÿ≥ÿßÿ™ ÿπŸÑÿßÿ¨Ÿäÿ© ÿµÿ∫Ÿäÿ±ÿ©.";
    analyzeBtn.textContent = "ÿßÿ≥ÿ™ŸÉÿ¥ŸêŸÅ ŸÖÿπŸä";
    clearBtn.textContent = "ŸÖÿ≥ÿ≠";
    inputText.placeholder = "ŸÖÿ´ÿßŸÑ: ÿ£ÿ¥ÿπÿ± ÿ®ÿ£ŸÜŸÜŸä ŸÖŸèÿ±ŸáŸÇ‚Ä¶";
    sunsetBtn.textContent = "üåÖ ÿßÿ≥ÿ™ÿ±ÿßÿ≠ÿ© ÿßŸÑÿ∫ÿ±Ÿàÿ® (60 ÿ´ÿßŸÜŸäÿ©)";
    if(autoOpt) autoOpt.textContent = "üåê ŸÑÿ∫ÿ© ÿßŸÑŸÜÿ∏ÿßŸÖ";
  }
  else {
    subtitle.textContent = "Before seeking a therapist, speak to your inner guide ‚Äî it‚Äôs the one that truly listens.";
    checkTitle.textContent = "Emotional Check-In";
    checkDesc.textContent = "Describe what you're feeling. You'll receive emotional reflection and therapeutic micro-practices.";
    analyzeBtn.textContent = "Reflect with me";
    clearBtn.textContent = "Clear";
    inputText.placeholder = "Ex: I feel overwhelmed‚Ä¶";
    sunsetBtn.textContent = "üåÖ Sunset Reset (60s)";
    if(autoOpt) autoOpt.textContent = "üåê System default";
  }

  /* ‚≠ê‚≠ê‚≠ê AJOUTE EXACTEMENT CES 4 LIGNES ICI ‚≠ê‚≠ê‚≠ê */
  const st = document.getElementById("subtitle");
  st.classList.remove("breathe");   // reset animation
  void st.offsetWidth;              // force reflow (restarts animation)
  st.classList.add("breathe");      // play animation
}

    applyLanguageUI();

    // ---------- Quotes by language ----------
    const QUOTES = {
      en: [
        "You don‚Äôt have to fix everything in this minute.",
        "Your feelings are valid, even when no one else sees them.",
        "Rest is not a reward. It‚Äôs a right.",
        "You are allowed to be a work in progress and still be worthy.",
        "Softening is not weakness. It is how light gets in.",
        "You have survived 100% of your hardest days.",
        "Your pace is sacred. You do not have to rush healing.",
        "Some chapters close so your nervous system can finally breathe.",
        "Even when the mind is loud, the body whispers the truth.",
        "You can start again at any breath.",
        "You are not behind. You are right on time for your own story.",
        "Tenderness with yourself is already a form of therapy.",
        "Every exhale is a small letting go.",
        "You are allowed to take up emotional space.",
        "Your sensitivity is not a flaw, it‚Äôs a compass.",
        "You are learning to stay with yourself, and that is huge."
      ],
      fr: [
        "Vous n‚Äôavez pas besoin de tout r√©gler dans cette minute.",
        "Vos √©motions sont l√©gitimes, m√™me si personne ne les voit.",
        "Le repos n‚Äôest pas une r√©compense. C‚Äôest un droit.",
        "Vous avez le droit d‚Äô√™tre en chantier et d√©j√† digne d‚Äôamour.",
        "S‚Äôadoucir n‚Äôest pas une faiblesse. C‚Äôest ainsi que la lumi√®re entre.",
        "Vous avez surv√©cu √† 100 % de vos jours les plus difficiles.",
        "Votre cadence est sacr√©e. Vous n‚Äôavez pas √† pr√©cipiter votre gu√©rison.",
        "Certains chapitres se ferment pour que votre syst√®me nerveux respire enfin.",
        "M√™me quand le mental crie, le corps murmure la v√©rit√©.",
        "Vous pouvez recommencer √† chaque respiration.",
        "Vous n‚Äô√™tes pas en retard. Vous √™tes √† l‚Äôheure de votre propre histoire.",
        "La douceur envers vous-m√™me est d√©j√† une forme de th√©rapie.",
        "Chaque expiration est un petit l√¢cher-prise.",
        "Vous avez le droit de prendre de la place, aussi dans vos √©motions.",
        "Votre sensibilit√© n‚Äôest pas un d√©faut, c‚Äôest une boussole.",
        "Vous apprenez √† rester avec vous-m√™me, et c‚Äôest immense."
      ],
      es: [
        "No tienes que arreglarlo todo en este minuto.",
        "Tus emociones son v√°lidas, aunque nadie m√°s las vea.",
        "El descanso no es una recompensa. Es un derecho.",
        "Tienes derecho a estar en construcci√≥n y seguir siendo digno de amor.",
        "Suavizarte no es debilidad. Es la forma en que entra la luz.",
        "Has sobrevivido al 100 % de tus d√≠as m√°s dif√≠ciles.",
        "Tu ritmo es sagrado. No tienes que apresurar tu sanaci√≥n.",
        "Algunos cap√≠tulos se cierran para que tu sistema nervioso pueda respirar.",
        "Aunque la mente grite, el cuerpo susurra la verdad.",
        "Puedes empezar de nuevo en cualquier respiraci√≥n.",
        "No vas tarde. Vas al tiempo de tu propia historia.",
        "La ternura contigo mismo ya es una forma de terapia.",
        "Cada exhalaci√≥n es un peque√±o soltar.",
        "Tienes derecho a ocupar espacio emocional.",
        "Tu sensibilidad no es un defecto, es una br√∫jula.",
        "Est√°s aprendiendo a quedarte contigo mismo, y eso es enorme."
      ],
      ar: [
        "ŸÑÿ≥ÿ™Ÿé ŸÖÿ∂ÿ∑ÿ±Ÿãÿß ŸÑÿ≠ŸÑŸë ŸÉŸÑ ÿ¥Ÿäÿ° ŸÅŸä Ÿáÿ∞Ÿá ÿßŸÑÿØŸÇŸäŸÇÿ©.",
        "ŸÖÿ¥ÿßÿπÿ±ŸÉ ÿ≠ŸÇŸäŸÇŸäÿ© ÿ≠ÿ™Ÿâ ŸÑŸà ŸÑŸÖ ŸäŸéÿ±ŸéŸáÿß ÿ£ÿ≠ÿØ.",
        "ÿßŸÑÿ±ÿßÿ≠ÿ© ŸÑŸäÿ≥ÿ™ ŸÖŸÉÿßŸÅÿ£ÿ©ÿå ÿ•ŸÜŸáÿß ÿ≠ŸÇ.",
        "Ÿäÿ≠ŸÇŸë ŸÑŸÉ ÿ£ŸÜ ÿ™ŸÉŸàŸÜ ŸÅŸä ÿ≠ÿßŸÑÿ© ÿ®ŸÜÿßÿ° ŸàŸÖÿß ÿ≤ŸÑÿ™Ÿé ÿ£ŸáŸÑŸãÿß ŸÑŸÑÿ≠ÿ®.",
        "ÿßŸÑŸÑŸäŸÜ ŸÑŸäÿ≥ ÿ∂ÿπŸÅŸãÿßÿå ŸáŸÉÿ∞ÿß ŸäÿØÿÆŸÑ ÿßŸÑŸÜŸàÿ± ÿ•ŸÑŸâ ŸÇŸÑÿ®ŸÉ.",
        "ŸÑŸÇÿØ ŸÜÿ¨Ÿàÿ™Ÿé ŸÖŸÜ 100Ÿ™ ŸÖŸÜ ÿ£ÿµÿπÿ® ÿ£ŸäÿßŸÖŸÉ.",
        "ÿ•ŸäŸÇÿßÿπŸÉ ŸÖŸÇÿØŸëÿ≥ÿå ŸÑÿß ÿ≠ÿßÿ¨ÿ© ŸÑÿ£ŸÜ ÿ™Ÿèÿ≥ÿ±Ÿêÿπ ÿ¥ŸÅÿßÿ°ŸÉ.",
        "ÿ£ÿ≠ŸäÿßŸÜŸãÿß ÿ™Ÿèÿ∫ŸÑŸéŸÇ ÿßŸÑŸÅÿµŸàŸÑ ŸÉŸä Ÿäÿ™ŸÖŸÉŸëŸÜ ÿ¨Ÿáÿßÿ≤ŸÉ ÿßŸÑÿπÿµÿ®Ÿä ŸÖŸÜ ÿßŸÑÿ™ŸÜŸÅŸëÿ≥.",
        "ÿ≠ÿ™Ÿâ ÿπŸÜÿØŸÖÿß Ÿäÿµÿ±ÿÆ ÿßŸÑÿπŸÇŸÑÿå ŸäŸáŸÖÿ≥ ÿßŸÑÿ¨ÿ≥ÿØ ÿ®ÿßŸÑÿ≠ŸÇŸäŸÇÿ©.",
        "ŸäŸÖŸÉŸÜŸÉ ÿ£ŸÜ ÿ™ÿ®ÿØÿ£ ŸÖŸÜ ÿ¨ÿØŸäÿØ ŸÖÿπ ŸÉŸÑ ÿ¥ŸáŸäŸÇ Ÿàÿ≤ŸÅŸäÿ±.",
        "ÿ£ŸÜÿ™ ŸÑÿ≥ÿ™ ŸÖÿ™ÿ£ÿÆÿ±Ÿãÿßÿå ÿ£ŸÜÿ™ ŸÅŸä ŸàŸÇÿ™ŸÉ ÿßŸÑÿÆÿßÿµ.",
        "ÿßŸÑÿ±ŸÅŸÇ ÿ®ŸÜŸÅÿ≥ŸÉ ŸáŸà ÿ®ÿßŸÑŸÅÿπŸÑ ÿ¥ŸÉŸÑ ŸÖŸÜ ÿ£ÿ¥ŸÉÿßŸÑ ÿßŸÑÿπŸÑÿßÿ¨.",
        "ŸÉŸÑ ÿ≤ŸÅŸäÿ± ŸáŸà ÿ•ŸÅÿ±ÿßÿ¨ ÿµÿ∫Ÿäÿ±.",
        "Ÿäÿ≠ŸÇŸë ŸÑŸÉ ÿ£ŸÜ ÿ™ÿ£ÿÆÿ∞ ŸÖŸÉÿßŸÜŸãÿß ÿ£Ÿäÿ∂Ÿãÿß ŸÅŸä ŸÖÿ¥ÿßÿπÿ±ŸÉ.",
        "ÿ≠ÿ≥ÿßÿ≥ŸäŸëÿ™ŸÉ ŸÑŸäÿ≥ÿ™ ÿπŸäÿ®Ÿãÿßÿå ÿ•ŸÜŸáÿß ÿ®ŸàÿµŸÑÿ©.",
        "ÿ£ŸÜÿ™ ÿ™ÿ™ÿπŸÑŸëŸÖ ÿ£ŸÜ ÿ™ÿ®ŸÇŸâ ŸÖÿπ ŸÜŸÅÿ≥ŸÉÿå ŸàŸáÿ∞ÿß ÿ•ŸÜÿ¨ÿßÿ≤ ŸÉÿ®Ÿäÿ±."
      ]
    };

    function getRandomQuote(langKey){
      const key = QUOTES[langKey] ? langKey : "en";
      const arr = QUOTES[key];
      return arr[Math.floor(Math.random() * arr.length)];
    }

    // ---------- Background slideshow ----------
    const slidesBG = document.querySelectorAll(".background-slideshow .slide");
    let bgIndex = 0;
    if(slidesBG.length > 0){
      setInterval(() => {
        slidesBG[bgIndex].classList.remove("active");
        bgIndex = (bgIndex + 1) % slidesBG.length;
        slidesBG[bgIndex].classList.add("active");
      }, 9000);
    }

    // ---------- Helper render ----------
    const resultEl   = document.getElementById("result");
    const statusEl   = document.getElementById("status");
    const sunsetBlock= document.getElementById("sunsetBlock");
    const analyzeBtn = document.getElementById("analyzeBtn");
    const clearBtn   = document.getElementById("clearBtn");
    const inputEl    = document.getElementById("inputText");

    function renderMessage(text){
      const div = document.createElement("div");
      div.className = "bubble";
      div.innerHTML = text;
      resultEl.innerHTML = "";
      resultEl.appendChild(div);
    }
    // ---------- A) Soulset internal banner texts ----------
const BANNER_TEXTS = {
  fr: {
    text: "‚ú® Recevez un mini-rituel SoulsetJourney chaque matin pour ancrer votre paix int√©rieure.",
    cta: "Recevoir mon rituel"
  },
  en: {
    text: "‚ú® Get a SoulsetJourney mini-ritual every morning to anchor your inner peace.",
    cta: "Get my ritual"
  },
  es: {
    text: "‚ú® Recibe un mini ritual SoulsetJourney cada ma√±ana para anclar tu paz interior.",
    cta: "Recibir mi ritual"
  },
  ar: {
    text: "‚ú® ÿßÿ≠ÿµŸÑ ÿπŸÑŸâ ÿ∑ŸÇÿ≥ SoulsetJourney ÿµÿ∫Ÿäÿ± ŸÉŸÑ ÿµÿ®ÿßÿ≠ ŸÑÿ™ÿπÿ≤Ÿäÿ≤ ÿ≥ŸÑÿßŸÖŸÉ ÿßŸÑÿØÿßÿÆŸÑŸä.",
    cta: "ÿßÿ≠ÿµŸÑ ÿπŸÑŸâ ÿ∑ŸÇÿ≥Ÿä"
  }
};

// üîó Mets ici TON LIEN SoulsetJourney (site / newsletter / store)
const SOULSET_LINK = "https://soulsetjourney.com"; // <-- change √ßa

function showSoulsetBanner(langKey){
  const banner = document.getElementById("soulsetBanner");
  if(!banner) return;

  const L = BANNER_TEXTS[langKey] || BANNER_TEXTS.en;

  banner.innerHTML = `
    <div class="soulset-banner">
      <div class="badge">‚òÄÔ∏è</div>
      <div class="text">${L.text}</div>
      <button class="cta" onclick="window.open('${SOULSET_LINK}','_blank')">${L.cta}</button>
    </div>
  `;
  banner.style.display = "block";
}

// ---------- C) Affiliate products (soft suggestion) ----------
const AFFILIATE_BY_THEME = {
  stress: [
    { name:{fr:"Diffuseur apaisant",en:"Calming diffuser",es:"Difusor calmante",ar:"ŸÖŸàÿ≤Ÿëÿπ ÿ±Ÿàÿßÿ¶ÿ≠ ŸÖŸáÿØÿ¶"}, icon:"ü´ß", url:"https://amzn.to/xxxxx1" },
    { name:{fr:"Bougie relaxante",en:"Relax candle",es:"Vela relajante",ar:"ÿ¥ŸÖÿπÿ© ÿßÿ≥ÿ™ÿ±ÿÆÿßÿ°"}, icon:"üïØÔ∏è", url:"https://amzn.to/xxxxx2" }
  ],
  fear: [
    { name:{fr:"Lampe douce",en:"Warm night lamp",es:"L√°mpara c√°lida",ar:"ŸÖÿµÿ®ÿßÿ≠ ÿØÿßŸÅÿ¶"}, icon:"üí°", url:"https://amzn.to/xxxxx3" }
  ],
  sadness: [
    { name:{fr:"Bracelet apaisant",en:"Calm bracelet",es:"Pulsera calmante",ar:"ÿ≥Ÿàÿßÿ± ŸÖŸáÿØÿ¶"}, icon:"üìø", url:"https://amzn.to/xxxxx4" }
  ],
  anger: [
    { name:{fr:"Encens bois doux",en:"Soft sandalwood incense",es:"Incienso suave",ar:"ÿ®ÿÆŸàÿ± ÿÆÿ¥ÿ® ŸÜÿßÿπŸÖ"}, icon:"üåø", url:"https://amzn.to/xxxxx5" }
  ],
  uncertainty: [
    { name:{fr:"Journal guid√©",en:"Guided journal",es:"Diario guiado",ar:"ÿØŸÅÿ™ÿ± ŸÖŸàÿ¨Ÿá"}, icon:"üìì", url:"https://amzn.to/xxxxx6" }
  ],
  inspiration: [
    { name:{fr:"Carnet cr√©atif",en:"Creative notebook",es:"Cuaderno creativo",ar:"ÿØŸÅÿ™ÿ± ÿ•ÿ®ÿØÿßÿπŸä"}, icon:"‚ú®", url:"https://amzn.to/xxxxx7" }
  ],
  neutral: [
    { name:{fr:"Brume relaxante",en:"Relax mist",es:"Bruma relajante",ar:"ÿ±ÿ∞ÿßÿ∞ ÿßÿ≥ÿ™ÿ±ÿÆÿßÿ°"}, icon:"üåô", url:"https://amzn.to/xxxxx8" }
  ]
};

// ‚ö†Ô∏è Remplace les url "amzn.to/xxxxx" par TES liens affili√©s
function pickAffiliate(theme, langKey){
  const key = AFFILIATE_BY_THEME[theme] ? theme : "neutral";
  const arr = AFFILIATE_BY_THEME[key];
  const item = arr[Math.floor(Math.random()*arr.length)];
  const label = item.name[langKey] || item.name.en;
  return { ...item, label };
}

function renderAffiliate(theme, langKey){
  const { icon, label, url } = pickAffiliate(theme, langKey);
  return `
    <div class="affiliate-card">
      <div class="ico">${icon}</div>
      <div class="copy">
        ${label} ‚Äî <a href="${url}" target="_blank" rel="noopener">Voir</a>
      </div>
    </div>
    <div class="affiliate-disclaimer">
      ${langKey==="fr" ? "Lien affili√© : sans co√ªt suppl√©mentaire pour vous." :
        langKey==="es" ? "Enlace afiliado: sin coste extra para ti." :
        langKey==="ar" ? "ÿ±ÿßÿ®ÿ∑ ÿ™ÿßÿ®ÿπ: ÿØŸàŸÜ ÿ£Ÿä ÿ™ŸÉŸÑŸÅÿ© ÿ•ÿ∂ÿßŸÅŸäÿ© ÿπŸÑŸäŸÉ." :
        "Affiliate link: no extra cost to you."}
    </div>
  `;
}

    // ---------- AI Analysis ----------
    analyzeBtn.onclick = async () => {
      const text = inputEl.value.trim();
      if(!text) return;

      const effectiveLang = analysisLang || baseLang;
      currentLang = effectiveLang;

      analyzeBtn.disabled = true;
      clearBtn.disabled   = true;

      statusEl.textContent =
        (effectiveLang === "fr") ? "Analyse en cours‚Ä¶" :
        (effectiveLang === "es") ? "Analizando‚Ä¶" :
        (effectiveLang === "ar") ? "ÿ¨ÿßÿ±Ÿä ÿßŸÑÿ™ÿ≠ŸÑŸäŸÑ..." :
        "Analyzing‚Ä¶";

      renderMessage("‚è≥ " +
        ((effectiveLang === "fr") ? "Je t‚Äô√©coute‚Ä¶" :
         (effectiveLang === "es") ? "Te escucho‚Ä¶" :
         (effectiveLang === "ar") ? "ÿ£ŸÜÿß ÿ£ÿ≥ÿ™ŸÖÿπ ÿ•ŸÑŸäŸÉ..." :
         "I‚Äôm listening‚Ä¶")
      );

      try{
        const res = await fetch("/api/analyze", {
          method:"POST",
          headers:{ "Content-Type":"application/json" },
          body:JSON.stringify({ text, lang: effectiveLang })
        });
        const data = await res.json();

        if(data.ok){
  // data.theme vient de ton analyze.js (stress/fear/etc.)
  const theme = data.theme || "neutral";

  // message IA
  renderMessage(data.text);

  // bloc affiliation discret sous l'analyse
  const affiliateHTML = renderAffiliate(theme, effectiveLang);
  resultEl.insertAdjacentHTML("beforeend", affiliateHTML);

  // banni√®re SoulsetJourney interne
  showSoulsetBanner(effectiveLang);

  sunsetBlock.style.display = "block";
  statusEl.textContent = "";
}
 else {
          renderMessage("‚ö†Ô∏è Something went wrong.");
          statusEl.textContent = "";
        }
      }catch(err){
        console.error(err);
        renderMessage("‚ö†Ô∏è Network error, please try again.");
        statusEl.textContent = "";
      } finally{
        analyzeBtn.disabled = false;
        clearBtn.disabled   = false;
      }
    };

    clearBtn.onclick = () => {
      inputEl.value = "";
      resultEl.innerHTML = "";
      statusEl.textContent = "";
      sunsetBlock.style.display = "none";
      document.getElementById("soulsetBanner").style.display="none";

    };

    // ---------- Random sounds & videos ----------
    const VIDEO_SOURCES = [
      "Sunset-1V.mp4",
      "Sunset-2V.mp4",
      "Sunset-3V.mp4",
      "Sunset-4V.mp4",
      "Sunset-ambient.mp4"
    ];

    const SOUND_SOURCES = [
      "sunset-soft.mp3",
      "sunset-ocean.mp3",
      "sunset-deep.mp3",
      "Sunset-ambient.mp4"
    ];

    function pickRandom(arr){
      return arr[Math.floor(Math.random() * arr.length)];
    }

    // ---------- Sunset Reset immersive ----------
    const FS         = document.getElementById("sunsetFS");
    const video      = document.getElementById("sunsetVideo");
    const timer      = document.getElementById("sunsetTimer");
    const sunsetBtn  = document.getElementById("sunsetBtn");
    const sunsetClose= document.getElementById("sunsetClose");
    const quoteEl    = document.getElementById("sunsetQuote");
    const audioEl    = document.getElementById("sunsetAudio");
    let countdown;

    function startSunsetReset(){
      // vid√©o al√©atoire
      const randomVideo = pickRandom(VIDEO_SOURCES);
      video.src = randomVideo;

      // son al√©atoire
      const randomSound = pickRandom(SOUND_SOURCES);
      audioEl.src = randomSound;

      FS.style.display = "flex";
      video.currentTime = 0;
      video.play().catch(()=>{});

      // quote dans la langue actuelle effective
      const quote = getRandomQuote(currentLang);
      quoteEl.textContent = quote;
      quoteEl.style.direction = (currentLang === "ar") ? "rtl" : "ltr";

      audioEl.currentTime = 0;
      audioEl.volume = 1;
      audioEl.play().catch(()=>{});

      let time = 60;
      timer.textContent = time;

      clearInterval(countdown);
      countdown = setInterval(() => {
        time--;
        timer.textContent = time;
        if(time <= 0){
          closeSunset();
        }
      }, 1000);
    }

    function closeSunset(){
      FS.style.display = "none";
      video.pause();
      audioEl.pause();
      audioEl.currentTime = 0;
      clearInterval(countdown);
    }

    if(sunsetBtn){
      sunsetBtn.onclick = startSunsetReset;
    }
    if(sunsetClose){
      sunsetClose.onclick = closeSunset;
    }
  </script>
</body>
<script>
if ("serviceWorker" in navigator) {
  navigator.serviceWorker.register("/service-worker.js").then((reg) => {
    if (reg.waiting) reg.waiting.postMessage("SKIP_WAITING");

    reg.addEventListener("updatefound", () => {
      const newSW = reg.installing;
      newSW.addEventListener("statechange", () => {
        if (newSW.state === "installed" && navigator.serviceWorker.controller) {
          newSW.postMessage("SKIP_WAITING");
          window.location.reload();
        }
      });
    });
  });
}
</script>

</html>
