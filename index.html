<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Soulset Navigator â€¢ Therapeutic Support</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@300;400;600;700&family=Playfair+Display:wght@600;700&display=swap" rel="stylesheet">

  <style>
    body{
      margin:0;
      font-family:Nunito, sans-serif;
      background:#050811;
      color:#f3f6ff;
      -webkit-font-smoothing:antialiased;
    }

    /* BACKGROUND SLIDESHOW â€“ FULLSCREEN + KEN BURNS EFFECT */
    .background-slideshow {
      position: fixed;
      inset: 0;
      width: 100%;
      height: 100vh;
      overflow: hidden;
      z-index: -2;
    }
    .background-slideshow .slide{
      position:absolute;
      top:-5%;
      left:-5%;
      width:110%;
      height:110%;
      object-fit:cover;
      opacity:0;
      transition:opacity 2.5s ease-in-out;
      animation:kenburns 22s ease-in-out infinite;
    }
    .background-slideshow .slide.active{
      opacity:1;
    }
    @keyframes kenburns{
      0%{transform:scale(1);}
      50%{transform:scale(1.08);}
      100%{transform:scale(1);}
    }

    /* Dark gradient overlay to keep text readable */
    .bg-overlay{
      position:fixed;
      inset:0;
      background:radial-gradient(circle at top, rgba(120,150,255,0.35), transparent 55%),
                 linear-gradient(to bottom, rgba(0,0,0,0.78), rgba(0,0,0,0.9));
      z-index:-1;
    }

    .page{
      min-height:100vh;
    }
    header{
      text-align:center;
      padding:30px 20px 8px;
    }
    header h1{
      font-family:"Playfair Display", serif;
      font-size:clamp(28px,4.8vw,38px);
      margin:0;
      letter-spacing:.04em;
    }
    header .subtitle{
      opacity:0.9;
      font-size:15px;
      margin-top:10px;
      max-width:520px;
      margin-left:auto;
      margin-right:auto;
    }

    .container{
      max-width:860px;
      margin:0 auto;
      padding:18px 20px 80px;
    }

    .card{
      background:rgba(6,12,28,0.92);
      border-radius:22px;
      padding:22px 20px;
      box-shadow:0 16px 40px rgba(0,0,0,0.45);
      margin-bottom:26px;
      border:1px solid rgba(255,255,255,0.04);
      backdrop-filter:blur(18px);
    }

    .card h2{
      margin:0 0 10px;
      font-size:20px;
      font-family:"Playfair Display", serif;
      letter-spacing:.03em;
    }

    .card p{
      margin-top:0;
      font-size:14px;
      color:#ccd4ff;
    }

    textarea{
      width:100%;
      min-height:110px;
      border-radius:14px;
      border:1.5px solid rgba(190,205,255,0.45);
      padding:14px;
      font-size:16px;
      background:rgba(5,10,30,0.9);
      resize:vertical;
      outline:none;
      color:#f3f6ff;
    }
    textarea::placeholder{
      color:#8992c5;
    }

    .actions{
      display:flex;
      gap:12px;
      margin-top:14px;
      flex-wrap:wrap;
    }

    .btn{
      flex:1;
      border:0;
      padding:13px 16px;
      border-radius:14px;
      font-size:15px;
      font-weight:700;
      cursor:pointer;
      background:#5aa3a6;
      color:white;
      box-shadow:0 10px 24px rgba(0,0,0,0.45);
    }
    .btn.secondary{
      background:transparent;
      border:1px solid rgba(190,205,255,0.45);
      color:#d7e0ff;
    }
    .btn:disabled{
      opacity:0.6;
      cursor:not-allowed;
    }

    #status{
      margin-top:10px;
      font-size:13px;
      color:#d0d8ff;
    }

    #result .bubble{
      margin-top:18px;
      background:rgba(4,10,30,0.96);
      padding:16px 18px;
      border-radius:16px;
      box-shadow:0 10px 30px rgba(0,0,0,0.6);
      line-height:1.65;
      white-space:pre-line;
      border:1px solid rgba(163,186,255,0.28);
      color:#eef2ff;
      font-size:15px;
    }

    .sunset-block{
      display:none;
      text-align:center;
      margin-top:10px;
    }
    .sunset-btn{
      background:rgba(9,20,55,0.9);
      padding:12px 22px;
      border-radius:18px;
      font-weight:700;
      box-shadow:0 10px 26px rgba(0,0,0,0.6);
      backdrop-filter:blur(14px);
      color:#f3f6ff;
      border:1px solid rgba(190,205,255,0.4);
      font-size:15px;
    }

    /* IMMERSIVE SUNSET RESET */
    .sunset-fullscreen{
      position:fixed;
      inset:0;
      background:black;
      display:none;
      justify-content:center;
      align-items:center;
      flex-direction:column;
      z-index:9999;
    }
    .sunset-fullscreen video{
      position:absolute;
      inset:0;
      width:100%;
      height:100%;
      object-fit:cover;
    }
    .sunset-close{
      position:absolute;
      top:26px;
      right:24px;
      font-size:28px;
      color:white;
      padding:6px 14px;
      background:#ffffff33;
      border-radius:12px;
      cursor:pointer;
      backdrop-filter:blur(10px);
    }
    .sunset-timer{
      position:absolute;
      bottom:60px;
      color:white;
      font-size:40px;
      font-weight:700;
      text-shadow:0 2px 10px rgba(0,0,0,0.6);
    }

    .sunset-quote{
      position:absolute;
      inset:0;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:0 22px;
      text-align:center;
      color:#ffffff;
      font-size:18px;
      font-weight:500;
      text-shadow:0 2px 14px rgba(0,0,0,0.85);
    }

    /* Sound controls */
    .sunset-controls{
      position:absolute;
      top:22px;
      left:20px;
      background:rgba(6,10,30,0.72);
      border-radius:18px;
      padding:10px 12px;
      color:#f5f7ff;
      font-size:12px;
      border:1px solid rgba(220,230,255,0.3);
      backdrop-filter:blur(12px);
      max-width:260px;
    }
    .sound-label{
      margin-bottom:6px;
      opacity:0.9;
      font-size:11px;
      letter-spacing:0.05em;
      text-transform:uppercase;
    }
    .sound-options{
      display:flex;
      flex-wrap:wrap;
      gap:6px;
      margin-bottom:6px;
    }
    .sound-chip,
    .voice-chip{
      border-radius:999px;
      border:1px solid rgba(220,230,255,0.4);
      background:transparent;
      color:#f5f7ff;
      font-size:11px;
      padding:4px 10px;
      cursor:pointer;
      white-space:nowrap;
    }
    .sound-chip.active,
    .voice-chip.active{
      background:#fefefe;
      color:#11152b;
    }
    .voice-chip{
      margin-top:2px;
      font-size:11px;
    }

    @media (max-width:600px){
      .card{
        padding:18px 16px;
      }
      .sunset-timer{
        bottom:40px;
      }
      .sunset-controls{
        max-width:90%;
        left:50%;
        transform:translateX(-50%);
      }
      .sunset-quote{
        font-size:16px;
        padding:0 18px;
      }
    }
  </style>
</head>

<body>
  <!-- FULLSCREEN BACKGROUND IMAGES -->
  <div class="background-slideshow">
    <img src="sunset-1.jpeg" class="slide active" alt="Sunset 1">
    <img src="sunset-2.jpeg" class="slide" alt="Sunset 2">
    <img src="sunset-3.jpeg" class="slide" alt="Sunset 3">
    <img src="Sunset-4.jpeg" class="slide" alt="Sunset 4">
    <img src="Sunset-5.jpeg" class="slide" alt="Sunset 5">
    <img src="Sunset-6.jpeg" class="slide" alt="Sunset 6">
    <img src="Sunset-7.jpeg" class="slide" alt="Sunset 7">
  </div>
  <div class="bg-overlay"></div>

  <div class="page">
    <header>
      <h1 id="title">Soulset Navigator</h1>
      <div class="subtitle" id="subtitle"></div>
    </header>

    <div class="container">
      <!-- EMOTIONAL CHECK-IN -->
      <section class="card">
        <h2 id="check-title">Emotional Check-In</h2>
        <p id="check-desc">
          Describe what you're feeling. You will receive emotional reflection and therapeutic micro-practices.
        </p>

        <textarea id="inputText" placeholder="Ex: I feel overwhelmedâ€¦"></textarea>

        <div class="actions">
          <button class="btn" id="analyzeBtn">Reflect with me</button>
          <button class="btn secondary" id="clearBtn">Clear</button>
        </div>

        <div id="status"></div>
        <div id="result"></div>
      </section>

      <!-- SUNSET RESET BUTTON -->
      <div class="sunset-block" id="sunsetBlock">
        <button class="sunset-btn" id="sunsetBtn">ðŸŒ… Sunset Reset (60s)</button>
      </div>
    </div>
  </div>

  <!-- IMMERSIVE SUNSET FULLSCREEN -->
  <div class="sunset-fullscreen" id="sunsetFS">
    <video id="sunsetVideo" autoplay muted playsinline>
      <source src="Sunset-1V.mp4" type="video/mp4">
    </video>
    <div class="sunset-quote" id="sunsetQuote"></div>
    <div class="sunset-timer" id="sunsetTimer">60</div>
    <div class="sunset-close" id="sunsetClose">Ã—</div>

    <div class="sunset-controls">
      <div class="sound-label" id="soundLabel">Sound</div>
      <div class="sound-options">
        <button class="sound-chip active" data-sound="soft" id="soundSoft">Soft</button>
        <button class="sound-chip" data-sound="ocean" id="soundOcean">Ocean</button>
        <button class="sound-chip" data-sound="deep" id="soundDeep">Deep</button>
        <button class="sound-chip" data-sound="ambient" id="soundAmbient">Ambient</button>
      </div>
      <button class="voice-chip" id="voiceToggle">ðŸŽ§ Voice guide (coming soon)</button>
    </div>
  </div>

  <!-- AUDIO (one element, source changed in JS) -->
  <audio id="sunsetAudio" preload="auto"></audio>

  <script>
    // ---------- Language + UI ----------
    const lang = (navigator.language || navigator.userLanguage || "en").substring(0,2).toLowerCase();

    function applyLanguageUI(){
      const subtitle = document.getElementById("subtitle");
      const checkTitle = document.getElementById("check-title");
      const checkDesc = document.getElementById("check-desc");
      const analyzeBtn = document.getElementById("analyzeBtn");
      const clearBtn = document.getElementById("clearBtn");
      const inputText = document.getElementById("inputText");
      const sunsetBtn = document.getElementById("sunsetBtn");
      const soundLabel = document.getElementById("soundLabel");
      const soundSoft = document.getElementById("soundSoft");
      const soundOcean = document.getElementById("soundOcean");
      const soundDeep = document.getElementById("soundDeep");
      const soundAmbient = document.getElementById("soundAmbient");
      const voiceToggle = document.getElementById("voiceToggle");

      if(lang === "fr"){
        subtitle.textContent = "Avant de parler Ã  un thÃ©rapeute, parlez Ã  votre guide intÃ©rieur. Il vous Ã©coute vraiment.";
        checkTitle.textContent = "Bilan Ã©motionnel";
        checkDesc.textContent = "DÃ©crivez ce que vous ressentez. Vous recevrez un miroir Ã©motionnel et des micro-pratiques thÃ©rapeutiques.";
        analyzeBtn.textContent = "Explorer avec moi";
        clearBtn.textContent = "Effacer";
        inputText.placeholder = "Ex : Je me sens submergÃ©(e)â€¦";
        sunsetBtn.textContent = "ðŸŒ… Pause Sunset (60 s)";
        soundLabel.textContent = "Ambiance sonore";
        soundSoft.textContent = "Doux";
        soundOcean.textContent = "OcÃ©an";
        soundDeep.textContent = "Profond";
        soundAmbient.textContent = "Ambient";
        voiceToggle.textContent = "ðŸŽ§ Guide vocal (bientÃ´t)";
      } else if(lang === "es"){
        subtitle.textContent = "Antes de hablar con un terapeuta, habla con tu guÃ­a interior. Ã‰l realmente te escucha.";
        checkTitle.textContent = "RevisiÃ³n emocional";
        checkDesc.textContent = "Describe lo que sientes. RecibirÃ¡s un espejo emocional y microprÃ¡cticas terapÃ©uticas.";
        analyzeBtn.textContent = "Explorar conmigo";
        clearBtn.textContent = "Borrar";
        inputText.placeholder = "Ej: Me siento abrumado(a)â€¦";
        sunsetBtn.textContent = "ðŸŒ… Pausa Sunset (60 s)";
        soundLabel.textContent = "Ambiente sonoro";
        soundSoft.textContent = "Suave";
        soundOcean.textContent = "OcÃ©ano";
        soundDeep.textContent = "Profundo";
        soundAmbient.textContent = "Ambiental";
        voiceToggle.textContent = "ðŸŽ§ GuÃ­a de voz (pronto)";
      } else if(lang === "ar"){
        subtitle.textContent = "Ù‚Ø¨Ù„ Ø£Ù† ØªØªØ­Ø¯Ø« Ù…Ø¹ Ù…Ø¹Ø§Ù„Ø¬ØŒ ØªØ­Ø¯Ù‘Ø« Ø¥Ù„Ù‰ Ø¯Ù„ÙŠÙ„Ùƒ Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠ. Ø¥Ù†Ù‡ ÙŠÙ†ØµØª Ø¥Ù„ÙŠÙƒ Ø­Ù‚Ù‹Ø§.";
        checkTitle.textContent = "ØªÙ‚ÙŠÙŠÙ… Ø¹Ø§Ø·ÙÙŠ";
        checkDesc.textContent = "ØµÙ Ù…Ø§ ØªØ´Ø¹Ø± Ø¨Ù‡. Ø³ØªØ­ØµÙ„ Ø¹Ù„Ù‰ Ø§Ù†Ø¹ÙƒØ§Ø³ Ø¹Ø§Ø·ÙÙŠ ÙˆÙ…Ù…Ø§Ø±Ø³Ø§Øª Ø¹Ù„Ø§Ø¬ÙŠØ© ØµØºÙŠØ±Ø©.";
        analyzeBtn.textContent = "Ø§Ø³ØªÙƒØ´ÙÙ Ù…Ø¹ÙŠ";
        clearBtn.textContent = "Ù…Ø³Ø­";
        inputText.placeholder = "Ù…Ø«Ø§Ù„: Ø£Ø´Ø¹Ø± Ø¨Ø£Ù†Ù†ÙŠ Ù…ÙØ±Ù‡Ù‚â€¦";
        sunsetBtn.textContent = "ðŸŒ… Ø§Ø³ØªØ±Ø§Ø­Ø© Ø§Ù„ØºØ±ÙˆØ¨ (60 Ø«Ø§Ù†ÙŠØ©)";
        soundLabel.textContent = "Ø§Ù„Ø£Ø¬ÙˆØ§Ø¡ Ø§Ù„ØµÙˆØªÙŠØ©";
        soundSoft.textContent = "Ù‡Ø§Ø¯Ø¦";
        soundOcean.textContent = "Ø¨Ø­Ø±";
        soundDeep.textContent = "Ø¹Ù…ÙŠÙ‚";
        soundAmbient.textContent = "Ù…Ø­Ù€ÙŠØ·ÙŠ";
        voiceToggle.textContent = "ðŸŽ§ Ù…Ø±Ø´Ø¯ ØµÙˆØªÙŠ (Ù‚Ø±ÙŠØ¨Ø§Ù‹)";
      } else {
        subtitle.textContent = "Before talking to a therapist, speak to your inner guide. It truly listens to you.";
        checkTitle.textContent = "Emotional Check-In";
        checkDesc.textContent = "Describe what you're feeling. You'll receive emotional reflection and therapeutic micro-practices.";
        analyzeBtn.textContent = "Reflect with me";
        clearBtn.textContent = "Clear";
        inputText.placeholder = "Ex: I feel overwhelmedâ€¦";
        sunsetBtn.textContent = "ðŸŒ… Sunset Reset (60s)";
        soundLabel.textContent = "Sound ambience";
        soundSoft.textContent = "Soft";
        soundOcean.textContent = "Ocean";
        soundDeep.textContent = "Deep";
        soundAmbient.textContent = "Ambient";
        voiceToggle.textContent = "ðŸŽ§ Voice guide (coming soon)";
      }
    }
    applyLanguageUI();

    // ---------- Quotes by language ----------
    const QUOTES = {
      en: [
        "You donâ€™t have to fix everything in this minute.",
        "Your feelings are valid, even when no one else sees them.",
        "Rest is not a reward. Itâ€™s a right.",
        "You are allowed to be a work in progress and still be worthy.",
        "Softening is not weakness. It is how light gets in.",
        "You have survived 100% of your hardest days.",
        "Your pace is sacred. You do not have to rush healing.",
        "Some chapters close so your nervous system can finally breathe.",
        "Even when the mind is loud, the body whispers the truth.",
        "You can start again at any breath.",
        "You are not behind. You are right on time for your own story.",
        "Tenderness with yourself is already a form of therapy.",
        "Every exhale is a small letting go.",
        "You are allowed to take up emotional space.",
        "Your sensitivity is not a flaw, itâ€™s a compass.",
        "You are learning to stay with yourself, and that is huge."
      ],
      fr: [
        "Vous nâ€™avez pas besoin de tout rÃ©gler dans cette minute.",
        "Vos Ã©motions sont lÃ©gitimes, mÃªme si personne ne les voit.",
        "Le repos nâ€™est pas une rÃ©compense. Câ€™est un droit.",
        "Vous avez le droit dâ€™Ãªtre en chantier et dÃ©jÃ  digne dâ€™amour.",
        "Sâ€™adoucir nâ€™est pas une faiblesse. Câ€™est ainsi que la lumiÃ¨re entre.",
        "Vous avez survÃ©cu Ã  100 % de vos jours les plus difficiles.",
        "Votre cadence est sacrÃ©e. Vous nâ€™avez pas Ã  prÃ©cipiter votre guÃ©rison.",
        "Certains chapitres se ferment pour que votre systÃ¨me nerveux respire enfin.",
        "MÃªme quand le mental crie, le corps murmure la vÃ©ritÃ©.",
        "Vous pouvez recommencer Ã  chaque respiration.",
        "Vous nâ€™Ãªtes pas en retard. Vous Ãªtes Ã  lâ€™heure de votre propre histoire.",
        "La douceur envers vous-mÃªme est dÃ©jÃ  une forme de thÃ©rapie.",
        "Chaque expiration est un petit lÃ¢cher-prise.",
        "Vous avez le droit de prendre de la place, aussi dans vos Ã©motions.",
        "Votre sensibilitÃ© nâ€™est pas un dÃ©faut, câ€™est une boussole.",
        "Vous apprenez Ã  rester avec vous-mÃªme, et câ€™est immense."
      ],
      es: [
        "No tienes que arreglarlo todo en este minuto.",
        "Tus emociones son vÃ¡lidas, aunque nadie mÃ¡s las vea.",
        "El descanso no es una recompensa. Es un derecho.",
        "Tienes derecho a estar en construcciÃ³n y seguir siendo digno de amor.",
        "Suavizarte no es debilidad. Es la forma en que entra la luz.",
        "Has sobrevivido al 100 % de tus dÃ­as mÃ¡s difÃ­ciles.",
        "Tu ritmo es sagrado. No tienes que apresurar tu sanaciÃ³n.",
        "Algunos capÃ­tulos se cierran para que tu sistema nervioso pueda respirar.",
        "Aunque la mente grite, el cuerpo susurra la verdad.",
        "Puedes empezar de nuevo en cualquier respiraciÃ³n.",
        "No vas tarde. Vas al tiempo de tu propia historia.",
        "La ternura contigo mismo ya es una forma de terapia.",
        "Cada exhalaciÃ³n es un pequeÃ±o soltar.",
        "Tienes derecho a ocupar espacio emocional.",
        "Tu sensibilidad no es un defecto, es una brÃºjula.",
        "EstÃ¡s aprendiendo a quedarte contigo mismo, y eso es enorme."
      ],
      ar: [
        "Ù„Ø³ØªÙŽ Ù…Ø¶Ø·Ø±Ù‹Ø§ Ù„Ø­Ù„Ù‘ ÙƒÙ„ Ø´ÙŠØ¡ ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„Ø¯Ù‚ÙŠÙ‚Ø©.",
        "Ù…Ø´Ø§Ø¹Ø±Ùƒ Ø­Ù‚ÙŠÙ‚ÙŠØ© Ø­ØªÙ‰ Ù„Ùˆ Ù„Ù… ÙŠÙŽØ±ÙŽÙ‡Ø§ Ø£Ø­Ø¯.",
        "Ø§Ù„Ø±Ø§Ø­Ø© Ù„ÙŠØ³Øª Ù…ÙƒØ§ÙØ£Ø©ØŒ Ø¥Ù†Ù‡Ø§ Ø­Ù‚.",
        "ÙŠØ­Ù‚Ù‘ Ù„Ùƒ Ø£Ù† ØªÙƒÙˆÙ† ÙÙŠ Ø­Ø§Ù„Ø© Ø¨Ù†Ø§Ø¡ ÙˆÙ…Ø§ Ø²Ù„ØªÙŽ Ø£Ù‡Ù„Ù‹Ø§ Ù„Ù„Ø­Ø¨.",
        "Ø§Ù„Ù„ÙŠÙ† Ù„ÙŠØ³ Ø¶Ø¹ÙÙ‹Ø§ØŒ Ù‡ÙƒØ°Ø§ ÙŠØ¯Ø®Ù„ Ø§Ù„Ù†ÙˆØ± Ø¥Ù„Ù‰ Ù‚Ù„Ø¨Ùƒ.",
        "Ù„Ù‚Ø¯ Ù†Ø¬ÙˆØªÙŽ Ù…Ù† 100Ùª Ù…Ù† Ø£ØµØ¹Ø¨ Ø£ÙŠØ§Ù…Ùƒ.",
        "Ø¥ÙŠÙ‚Ø§Ø¹Ùƒ Ù…Ù‚Ø¯Ù‘Ø³ØŒ Ù„Ø§ Ø­Ø§Ø¬Ø© Ù„Ø£Ù† ØªÙØ³Ø±ÙØ¹ Ø´ÙØ§Ø¡Ùƒ.",
        "Ø£Ø­ÙŠØ§Ù†Ù‹Ø§ ØªÙØºÙ„ÙŽÙ‚ Ø§Ù„ÙØµÙˆÙ„ ÙƒÙŠ ÙŠØªÙ…ÙƒÙ‘Ù† Ø¬Ù‡Ø§Ø²Ùƒ Ø§Ù„Ø¹ØµØ¨ÙŠ Ù…Ù† Ø§Ù„ØªÙ†ÙÙ‘Ø³.",
        "Ø­ØªÙ‰ Ø¹Ù†Ø¯Ù…Ø§ ÙŠØµØ±Ø® Ø§Ù„Ø¹Ù‚Ù„ØŒ ÙŠÙ‡Ù…Ø³ Ø§Ù„Ø¬Ø³Ø¯ Ø¨Ø§Ù„Ø­Ù‚ÙŠÙ‚Ø©.",
        "ÙŠÙ…ÙƒÙ†Ùƒ Ø£Ù† ØªØ¨Ø¯Ø£ Ù…Ù† Ø¬Ø¯ÙŠØ¯ Ù…Ø¹ ÙƒÙ„ Ø´Ù‡ÙŠÙ‚ ÙˆØ²ÙÙŠØ±.",
        "Ø£Ù†Øª Ù„Ø³Øª Ù…ØªØ£Ø®Ø±Ù‹Ø§ØŒ Ø£Ù†Øª ÙÙŠ ÙˆÙ‚ØªÙƒ Ø§Ù„Ø®Ø§Øµ.",
        "Ø§Ù„Ø±ÙÙ‚ Ø¨Ù†ÙØ³Ùƒ Ù‡Ùˆ Ø¨Ø§Ù„ÙØ¹Ù„ Ø´ÙƒÙ„ Ù…Ù† Ø£Ø´ÙƒØ§Ù„ Ø§Ù„Ø¹Ù„Ø§Ø¬.",
        "ÙƒÙ„ Ø²ÙÙŠØ± Ù‡Ùˆ Ø¥ÙØ±Ø§Ø¬ ØµØºÙŠØ±.",
        "ÙŠØ­Ù‚Ù‘ Ù„Ùƒ Ø£Ù† ØªØ£Ø®Ø° Ù…ÙƒØ§Ù†Ù‹Ø§ Ø£ÙŠØ¶Ù‹Ø§ ÙÙŠ Ù…Ø´Ø§Ø¹Ø±Ùƒ.",
        "Ø­Ø³Ø§Ø³ÙŠÙ‘ØªÙƒ Ù„ÙŠØ³Øª Ø¹ÙŠØ¨Ù‹Ø§ØŒ Ø¥Ù†Ù‡Ø§ Ø¨ÙˆØµÙ„Ø©.",
        "Ø£Ù†Øª ØªØªØ¹Ù„Ù‘Ù… Ø£Ù† ØªØ¨Ù‚Ù‰ Ù…Ø¹ Ù†ÙØ³ÙƒØŒ ÙˆÙ‡Ø°Ø§ Ø¥Ù†Ø¬Ø§Ø² ÙƒØ¨ÙŠØ±."
      ]
    };

    function getRandomQuote(langKey){
      const key = QUOTES[langKey] ? langKey : "en";
      const arr = QUOTES[key];
      return arr[Math.floor(Math.random() * arr.length)];
    }

    // ---------- Background slideshow ----------
    const slidesBG = document.querySelectorAll(".background-slideshow .slide");
    let bgIndex = 0;
    if(slidesBG.length > 0){
      setInterval(() => {
        slidesBG[bgIndex].classList.remove("active");
        bgIndex = (bgIndex + 1) % slidesBG.length;
        slidesBG[bgIndex].classList.add("active");
      }, 9000);
    }

    // ---------- Helper render ----------
    const resultEl   = document.getElementById("result");
    const statusEl   = document.getElementById("status");
    const sunsetBlock= document.getElementById("sunsetBlock");
    const analyzeBtn = document.getElementById("analyzeBtn");
    const clearBtn   = document.getElementById("clearBtn");
    const inputEl    = document.getElementById("inputText");

    function renderMessage(text){
      const div = document.createElement("div");
      div.className = "bubble";
      div.innerHTML = text;
      resultEl.innerHTML = "";
      resultEl.appendChild(div);
    }

    // ---------- AI Analysis ----------
    analyzeBtn.onclick = async () => {
      const text = inputEl.value.trim();
      if(!text) return;

      analyzeBtn.disabled = true;
      clearBtn.disabled   = true;
      statusEl.textContent = (lang === "fr") ? "Analyse en coursâ€¦" :
                             (lang === "es") ? "Analizandoâ€¦" :
                             (lang === "ar") ? "Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù„ÙŠÙ„..." :
                             "Analyzingâ€¦";
      renderMessage("â³ " + ((lang === "fr") ? "Je tâ€™Ã©couteâ€¦" :
                             (lang === "es") ? "Te escuchoâ€¦" :
                             (lang === "ar") ? "Ø£Ù†Ø§ Ø£Ø³ØªÙ…Ø¹ Ø¥Ù„ÙŠÙƒ..." :
                             "Iâ€™m listeningâ€¦"));

      try{
        const res = await fetch("/api/analyze", {
          method:"POST",
          headers:{ "Content-Type":"application/json" },
          body:JSON.stringify({ text, lang })
        });
        const data = await res.json();

        if(data.ok){
          renderMessage(data.text);
          sunsetBlock.style.display = "block";
          statusEl.textContent = "";
        } else {
          renderMessage("âš ï¸ Something went wrong.");
          statusEl.textContent = "";
        }
      }catch(err){
        console.error(err);
        renderMessage("âš ï¸ Network error, please try again.");
        statusEl.textContent = "";
      } finally{
        analyzeBtn.disabled = false;
        clearBtn.disabled   = false;
      }
    };

    clearBtn.onclick = () => {
      inputEl.value = "";
      resultEl.innerHTML = "";
      statusEl.textContent = "";
      sunsetBlock.style.display = "none";
    };

    // ---------- Sound selection ----------
    const SOUND_MAP = {
      soft:    "sunset-soft.mp3",
      ocean:   "sunset-ocean.mp3",
      deep:    "sunset-deep.mp3",
      ambient: "Sunset-ambient.mp4"   // tu peux le remplacer plus tard par un .mp3
    };

    // optionnel : voix guidÃ©e par langue (Ã  ajouter plus tard)
    const VOICE_MAP = {
      fr: "voice-fr.mp3",
      en: "voice-en.mp3",
      es: "voice-es.mp3",
      ar: "voice-ar.mp3"
    };

    const soundChips  = document.querySelectorAll(".sound-chip");
    const voiceToggle = document.getElementById("voiceToggle");
    let currentSoundKey = "soft";
    let voiceEnabled = false;

    soundChips.forEach(btn => {
      btn.addEventListener("click", () => {
        soundChips.forEach(b => b.classList.remove("active"));
        btn.classList.add("active");
        currentSoundKey = btn.dataset.sound;
      });
    });

    voiceToggle.addEventListener("click", () => {
      voiceEnabled = !voiceEnabled;
      voiceToggle.classList.toggle("active", voiceEnabled);
    });

    // ---------- Sunset Reset immersive ----------
    const FS         = document.getElementById("sunsetFS");
    const video      = document.getElementById("sunsetVideo");
    const timer      = document.getElementById("sunsetTimer");
    const sunsetBtn  = document.getElementById("sunsetBtn");
    const sunsetClose= document.getElementById("sunsetClose");
    const quoteEl    = document.getElementById("sunsetQuote");
    const audioEl    = document.getElementById("sunsetAudio");
    let countdown;

    function startSunsetReset(){
      FS.style.display = "flex";
      video.currentTime = 0;
      video.play();

      // quote
      const quote = getRandomQuote(lang);
      quoteEl.textContent = quote;
      quoteEl.style.direction = (lang === "ar") ? "rtl" : "ltr";

      // choose sound or voice
      const langKey = QUOTES[lang] ? lang : "en";
      let src = SOUND_MAP[currentSoundKey] || SOUND_MAP.soft;
      if(voiceEnabled && VOICE_MAP[langKey]){
        src = VOICE_MAP[langKey];   // Ã  utiliser quand tu ajouteras les fichiers voix
      }
      audioEl.src = src;
      audioEl.currentTime = 0;
      audioEl.volume = 1;
      audioEl.play().catch(()=>{ /* iOS peut bloquer si pas dâ€™interaction */ });

      let time = 60;
      timer.textContent = time;

      clearInterval(countdown);
      countdown = setInterval(() => {
        time--;
        timer.textContent = time;
        if(time <= 0){
          closeSunset();
        }
      }, 1000);
    }

    function closeSunset(){
      FS.style.display = "none";
      video.pause();
      audioEl.pause();
      audioEl.currentTime = 0;
      clearInterval(countdown);
    }

    if(sunsetBtn){
      sunsetBtn.onclick = startSunsetReset;
    }
    if(sunsetClose){
      sunsetClose.onclick = closeSunset;
    }
  </script>
</body>
</html>
